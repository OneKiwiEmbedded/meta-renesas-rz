From be46bf2daac7fd656b2022f42cead7687b21f0bf Mon Sep 17 00:00:00 2001
From: Tran Minh Bao Loc <loc.tran-bao@banvien.com.vn>
Date: Fri, 4 Aug 2023 11:50:00 +0700
Subject: [PATCH] gst plugins base videoencoder fix error w I420 format

Signed-off-by: Chien Nguyen <chien.nguyen.eb@rvc.renesas.com>
---
 gst-libs/gst/video/gstvideoencoder.c | 6 +++---
 gst-libs/gst/video/gstvideoencoder.h | 1 +
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/gst-libs/gst/video/gstvideoencoder.c b/gst-libs/gst/video/gstvideoencoder.c
index 3205d26..9ef26e7 100644
--- a/gst-libs/gst/video/gstvideoencoder.c
+++ b/gst-libs/gst/video/gstvideoencoder.c
@@ -227,8 +227,8 @@ static GstFlowReturn gst_video_encoder_chain (GstPad * pad, GstObject * parent,
     GstBuffer * buf);
 static GstStateChangeReturn gst_video_encoder_change_state (GstElement *
     element, GstStateChange transition);
-static gboolean gst_video_encoder_sink_query (GstPad * pad, GstObject * parent,
-    GstQuery * query);
+// static gboolean gst_video_encoder_sink_query (GstPad * pad, GstObject * parent,
+    // GstQuery * query);
 static gboolean gst_video_encoder_src_query (GstPad * pad, GstObject * parent,
     GstQuery * query);
 static GstVideoCodecFrame *gst_video_encoder_new_frame (GstVideoEncoder *
@@ -886,7 +886,7 @@ error:
   return res;
 }
 
-static gboolean
+gboolean
 gst_video_encoder_sink_query (GstPad * pad, GstObject * parent,
     GstQuery * query)
 {
diff --git a/gst-libs/gst/video/gstvideoencoder.h b/gst-libs/gst/video/gstvideoencoder.h
index 24ea7ed..c438bfc 100644
--- a/gst-libs/gst/video/gstvideoencoder.h
+++ b/gst-libs/gst/video/gstvideoencoder.h
@@ -364,6 +364,7 @@ GST_VIDEO_API
 void                 gst_video_encoder_get_allocator (GstVideoEncoder *encoder,
                                                       GstAllocator **allocator,
                                                       GstAllocationParams *params);
+gboolean 			 gst_video_encoder_sink_query (GstPad * pad, GstObject * parent, GstQuery * query);
 
 GST_VIDEO_API
 void                 gst_video_encoder_set_min_pts(GstVideoEncoder *encoder, GstClockTime min_pts);
-- 
2.25.1

